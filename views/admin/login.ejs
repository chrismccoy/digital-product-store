<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Login // </title>
    <link href="/css/app.css" rel="stylesheet" />
  </head>
  <body class="bg-white text-black font-mono">
    <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
      <header
        class="flex justify-between items-center py-4 border-b-4 border-black"
      >
        <h1 class="text-2xl md:text-3xl font-bold uppercase">
          <a href="/admin/login" class="hover:bg-yellow-300">Login</a>
        </h1>
        <p class="hidden md:block text-lg font-bold">ADMIN PANEL</p>
      </header>

      <main>
        <section class="text-center py-12 md:py-16">
          <h2
            class="text-5xl md:text-7xl lg:text-8xl font-extrabold uppercase tracking-tighter"
          >
            System Access
          </h2>
          <p class="max-w-2xl mx-auto mt-6 text-lg">
            Authenticate to access the product management dashboard.
          </p>
        </section>

        <section class="max-w-lg mx-auto">
          <form
            id="login-form"
            method="POST"
            class="border-2 border-black p-8 space-y-6"
          >
            <div
              id="error-message-container"
              class="hidden border-2 border-red-600 bg-red-50 p-4 text-left"
            ></div>

            <div>
              <label
                for="username"
                class="block text-lg font-bold uppercase mb-2"
              >
                Username
              </label>
              <input
                type="text"
                id="username"
                name="username"
                required
                class="w-full p-4 bg-white border-2 border-black text-lg focus:outline-none focus:ring-4 focus:ring-yellow-300"
              />
            </div>
            <div>
              <label
                for="password"
                class="block text-lg font-bold uppercase mb-2"
              >
                Password
              </label>
              <input
                type="password"
                id="password"
                name="password"
                required
                class="w-full p-4 bg-white border-2 border-black text-lg focus:outline-none focus:ring-4 focus:ring-yellow-300"
              />
            </div>
            <div>
              <button
                id="submit-btn"
                type="submit"
                class="w-full px-8 py-4 bg-yellow-300 text-black text-xl font-bold border-2 border-black uppercase transition-all duration-150 hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[8px_8px_0px_#000]"
              >
                Login
              </button>
            </div>
          </form>
        </section>
      </main>

      <footer class="py-12 mt-16 border-t-4 border-black text-center">
        <p class="mt-12 text-sm text-neutral-600">
          &copy; 2025 BRUTALKIT.COM. ALL RIGHTS RESERVED.
        </p>
      </footer>
    </div>

    <script>
      const loginForm = document.getElementById("login-form");
      const submitBtn = document.getElementById("submit-btn");
      const errorContainer = document.getElementById(
        "error-message-container",
      );
      const usernameInput = document.getElementById("username");
      const passwordInput = document.getElementById("password");

      // Attach listener to handle form submission.
      loginForm.addEventListener("submit", async (event) => {
        event.preventDefault(); // Prevent the default browser form submission.
        hideError();

        // Provide visual feedback to the user during the request.
        submitBtn.disabled = true;
        submitBtn.textContent = "Authenticating...";

        const formData = new FormData(loginForm);
        const loginData = Object.fromEntries(formData.entries());

        try {
          // Send login credentials to the server via a POST request.
          const response = await fetch("/admin/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(loginData),
          });

          if (response.ok) {
            // On successful login (status 200-299), redirect to the dashboard.
            window.location.href = "/admin/dashboard";
          } else {
            // If the server responds with an error, display it.
            const result = await response.json();
            showError(result.message || "An unknown error occurred.");
          }
        } catch (error) {
          // Handle network errors (e.g., server is down).
          showError(
            "Could not connect to the server. Please try again later.",
          );
        } finally {
          // Re-enable the submit button regardless of the outcome.
          submitBtn.disabled = false;
          submitBtn.textContent = "Login";
        }
      });

      // Hide error messages as soon as the user starts typing again.
      const hideErrorOnInput = () => hideError();
      usernameInput.addEventListener("input", hideErrorOnInput);
      passwordInput.addEventListener("input", hideErrorOnInput);

      /** Displays a formatted error message in the error container. */
      function showError(message) {
        const errorContent = `
            <p class="font-bold uppercase text-red-700">Authentication Failed</p>
            <p class="mt-1 text-red-800">${message}</p>
        `;
        errorContainer.innerHTML = errorContent;
        errorContainer.classList.remove("hidden");
      }

      /** Hides and clears the error message container. */
      function hideError() {
        errorContainer.classList.add("hidden");
        errorContainer.innerHTML = "";
      }
    </script>
  </body>
</html>
